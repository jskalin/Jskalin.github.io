<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Dashboard - PropComply Platform</title>
    
    <!-- Performance Optimizations -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://api.propcomply.com">
    
    <!-- Critical CSS for instant loading -->
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; background: #f8fafc; }
        .page-loader { position: fixed; inset: 0; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .loader-content { text-align: center; color: white; }
        .spinner { width: 50px; height: 50px; border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .loading-text { font-size: 1.2rem; margin: 1rem 0 0.5rem 0; }
        .loading-subtitle { opacity: 0.8; font-size: 0.9rem; }
    </style>
    
    <!-- Enhanced Stylesheets -->
    <link rel="stylesheet" href="../styles/design-system.css">
    <link rel="stylesheet" href="../styles/components.css">
    <link rel="stylesheet" href="../styles/ultimate-dashboard.css">
    <link rel="stylesheet" href="../styles/role-themes.css">
    
    <!-- Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <!-- Charts & Visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    
    <!-- Progressive Web App -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- Enhanced Meta Tags -->
    <meta name="description" content="Ultimate role-adaptive dashboard for the PropComply platform with real-time analytics, comprehensive management tools, and never-sleeping notification system">
    <meta name="keywords" content="dashboard, proptech, real estate, analytics, CRM, role-based, notifications, calculations">
</head>
<body class="ultimate-dashboard" data-user-role="" data-loading="true">
    <!-- Page Loader with Personality -->
    <div id="page-loader" class="page-loader">
        <div class="loader-content">
            <div class="spinner"></div>
            <div class="loading-text">PropComply Ultimate</div>
            <div class="loading-subtitle">Crafting your magnificent experience...</div>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
        </div>
    </div>

    <!-- Real-Time Status Bar - Never Sleeps -->
    <div id="status-bar" class="status-bar enhanced">
        <div class="status-section">
            <div class="status-indicator">
                <div class="status-dot pulsing" id="connection-status"></div>
                <span id="connection-text">Connected</span>
                <span class="status-uptime" id="uptime">00:00:00</span>
            </div>
            <div class="sync-indicator">
                <i class="fas fa-sync-alt rotating" id="sync-icon"></i>
                <span id="last-sync">Synced now</span>
            </div>
            <div class="calculation-indicator">
                <i class="fas fa-calculator text-success"></i>
                <span id="calc-status">All calculations accurate</span>
            </div>
        </div>
        
        <div class="status-metrics" id="global-metrics">
            <div class="metric-item">
                <span class="metric-label">Active Users</span>
                <span class="metric-value" id="active-users">0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">Notifications</span>
                <span class="metric-value" id="pending-notifications">0</span>
            </div>
            <div class="metric-item">
                <span class="metric-label">Calculations</span>
                <span class="metric-value text-success" id="calculation-accuracy">100%</span>
            </div>
        </div>
        
        <div class="status-actions">
            <button class="status-btn" id="theme-toggle" title="Toggle theme">
                <i class="fas fa-moon"></i>
            </button>
            <button class="status-btn notification-btn" id="notifications-toggle" title="Notifications">
                <i class="fas fa-bell"></i>
                <span class="notification-badge pulsing" id="notification-count">0</span>
            </button>
            <button class="status-btn" id="refresh-data" title="Refresh data">
                <i class="fas fa-refresh"></i>
            </button>
            <button class="status-btn" id="fullscreen-toggle" title="Toggle fullscreen">
                <i class="fas fa-expand"></i>
            </button>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Main Dashboard Container -->
    <div class="dashboard-container">
        <!-- Unified Sidebar Navigation -->
        <nav class="sidebar enhanced" id="main-sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-building gradient-icon"></i>
                    <span class="logo-text">PropComply</span>
                    <span class="logo-badge">Ultimate</span>
                </div>
                <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle sidebar">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <!-- User Profile Section -->
            <div class="user-profile-section enhanced">
                <div class="user-avatar" id="user-avatar">
                    <i class="fas fa-user"></i>
                    <div class="avatar-status online"></div>
                </div>
                <div class="user-info">
                    <div class="user-name" id="user-name">Loading...</div>
                    <div class="user-role" id="user-role-display">User</div>
                    <div class="user-hierarchy" id="user-hierarchy">Level 0</div>
                    <div class="user-status online">
                        <i class="fas fa-circle"></i>
                        <span id="user-status-text">Online</span>
                    </div>
                </div>
                <div class="profile-actions">
                    <button class="profile-btn" id="profile-settings" title="Profile Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="profile-btn" id="role-info" title="Role Information">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>

            <!-- Real-Time Activity Feed -->
            <div class="activity-feed" id="sidebar-activity">
                <div class="activity-header">
                    <h6>Live Activity</h6>
                    <span class="activity-count" id="activity-count">0</span>
                </div>
                <div class="activity-list" id="activity-list">
                    <!-- Dynamic activity items -->
                </div>
            </div>

            <!-- Dynamic Navigation Menu -->
            <div class="sidebar-menu" id="dynamic-menu">
                <!-- Navigation items will be populated based on user role -->
            </div>

            <!-- Quick Stats in Sidebar -->
            <div class="sidebar-stats" id="sidebar-stats">
                <div class="stat-item">
                    <i class="fas fa-users"></i>
                    <div class="stat-content">
                        <span class="stat-value" id="sidebar-users">0</span>
                        <span class="stat-label">Users</span>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-home"></i>
                    <div class="stat-content">
                        <span class="stat-value" id="sidebar-properties">0</span>
                        <span class="stat-label">Properties</span>
                    </div>
                </div>
                <div class="stat-item">
                    <i class="fas fa-dollar-sign"></i>
                    <div class="stat-content">
                        <span class="stat-value" id="sidebar-revenue">$0</span>
                        <span class="stat-label">Revenue</span>
                    </div>
                </div>
            </div>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer">
                <div class="footer-actions">
                    <button class="footer-btn" id="settings-btn" title="Settings">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </button>
                    <button class="footer-btn" id="help-btn" title="Help & Support">
                        <i class="fas fa-question-circle"></i>
                        <span>Help</span>
                    </button>
                    <button class="footer-btn logout-btn" id="logout-btn" title="Logout">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>
                <div class="footer-info">
                    <span class="version">v2.0.0 Ultimate</span>
                    <span class="uptime" id="footer-uptime">Online</span>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dynamic Header -->
            <header class="content-header enhanced">
                <div class="header-left">
                    <h1 class="page-title" id="dynamic-title">Ultimate Dashboard</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb" id="dynamic-breadcrumb">
                            <li class="breadcrumb-item active">Dashboard</li>
                        </ol>
                    </nav>
                </div>
                <div class="header-center">
                    <div class="search-container">
                        <input type="text" class="search-input" id="global-search" placeholder="Search anything...">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-metrics">
                        <div class="metric-chip">
                            <i class="fas fa-eye text-primary"></i>
                            <span id="header-active-users">0</span>
                        </div>
                        <div class="metric-chip">
                            <i class="fas fa-bell text-warning"></i>
                            <span id="header-notifications">0</span>
                        </div>
                        <div class="metric-chip">
                            <i class="fas fa-calculator text-success"></i>
                            <span id="header-calculations">100%</span>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-outline-primary" id="quick-action-btn">
                            <i class="fas fa-plus"></i>
                            <span id="quick-action-text">Quick Action</span>
                        </button>
                        <button class="btn btn-primary" id="primary-action-btn">
                            <i class="fas fa-rocket"></i>
                            <span id="primary-action-text">Get Started</span>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Role-Adaptive Content Area -->
            <div class="content-body" id="main-content-area">
                <!-- Welcome Section -->
                <section class="welcome-section enhanced" id="welcome-section">
                    <div class="welcome-card">
                        <div class="welcome-content">
                            <div class="welcome-text">
                                <h2 class="welcome-title" id="welcome-title">Welcome to PropComply Ultimate!</h2>
                                <p class="welcome-description" id="welcome-description">
                                    Your magnificent dashboard is ready with real-time notifications, precise calculations, and role-adaptive intelligence.
                                </p>
                                <div class="welcome-features">
                                    <span class="feature-badge">
                                        <i class="fas fa-bell"></i>
                                        Never-Sleeping Notifications
                                    </span>
                                    <span class="feature-badge">
                                        <i class="fas fa-calculator"></i>
                                        Perfect Calculations
                                    </span>
                                    <span class="feature-badge">
                                        <i class="fas fa-users"></i>
                                        Role-Based Intelligence
                                    </span>
                                </div>
                            </div>
                            <div class="welcome-actions">
                                <button class="btn btn-primary btn-lg" id="welcome-primary-action">
                                    <i class="fas fa-play"></i>
                                    <span id="welcome-action-text">Enter Your Dashboard</span>
                                </button>
                                <button class="btn btn-outline-secondary" id="welcome-tour-action">
                                    <i class="fas fa-route"></i>
                                    Take a Tour
                                </button>
                            </div>
                        </div>
                        <div class="welcome-visual">
                            <div class="gradient-orb orb-1"></div>
                            <div class="gradient-orb orb-2"></div>
                            <div class="gradient-orb orb-3"></div>
                            <div class="floating-icons">
                                <i class="fas fa-bell"></i>
                                <i class="fas fa-calculator"></i>
                                <i class="fas fa-users"></i>
                                <i class="fas fa-home"></i>
                                <i class="fas fa-chart-line"></i>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Real-Time Metrics Grid -->
                <section class="metrics-section" id="metrics-section">
                    <div class="section-header">
                        <h3>Real-Time Metrics</h3>
                        <div class="section-actions">
                            <button class="btn btn-sm btn-outline-primary" id="refresh-metrics">
                                <i class="fas fa-refresh"></i>
                                Refresh
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" id="export-metrics">
                                <i class="fas fa-download"></i>
                                Export
                            </button>
                        </div>
                    </div>
                    <div class="metrics-grid" id="dynamic-metrics">
                        <!-- Metrics cards will be populated based on user role -->
                    </div>
                </section>

                <!-- Dynamic Dashboard Sections -->
                <div class="dashboard-sections" id="dashboard-sections">
                    <!-- Sections will be populated based on user role -->
                </div>

                <!-- Notification Center -->
                <section class="notification-center" id="notification-center" style="display: none;">
                    <div class="section-header">
                        <h3>Notification Center</h3>
                        <div class="section-actions">
                            <button class="btn btn-sm btn-outline-primary" id="mark-all-read">
                                <i class="fas fa-check"></i>
                                Mark All Read
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" id="clear-notifications">
                                <i class="fas fa-trash"></i>
                                Clear All
                            </button>
                        </div>
                    </div>
                    <div class="notification-list" id="notification-list">
                        <!-- Notifications will be populated here -->
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Client Card Popup Modal -->
    <div class="modal fade" id="clientCardModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Client Information</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="clientCardContent">
                    <!-- Client card content will be populated here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="clientCardAction">Take Action</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../scripts/utils/constants.js"></script>
    <script src="../scripts/utils/helpers.js"></script>
    <script src="../scripts/services/api-service.js"></script>
    <script src="../scripts/services/auth-service.js"></script>
    <script src="../scripts/services/notification-service.js"></script>
    <script src="../scripts/services/calculation-service.js"></script>
    <script src="../scripts/components/dashboard-manager.js"></script>
    <script src="../scripts/components/role-manager.js"></script>
    <script src="../scripts/components/metrics-manager.js"></script>
    <script src="../scripts/ultimate-dashboard.js"></script>
</body>
</html>